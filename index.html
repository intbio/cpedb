<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>CPE DB</title>
    <meta name="author" content="Derek Eder">
    <meta content="Display any CSV file as a searchable, filterable, pretty HTML table" />

    <!-- Bootstrap core CSS -->
	
	<link rel="stylesheet" type="text/css" href="DataTables/Bootstrap-3.3.7/css/bootstrap.min.css"/>	
	<link rel="stylesheet" type="text/css" href="DataTables/datatables.min.css"/> 

	<link rel="stylesheet" type="text/css" href="css/cpe_db.css"/>



       
	
  </head>

  <body>
    <div class="container-fluid">

      <h2>Chemical Penetration Enhancer Database</h2>

      <h3>Welcome to CPE DB, the curated database of chemical penetration enhancers!</h3>

      <h3>Contributors:</h3>
	  <ul>
		  <li>Marine Bozdaganyan — Project leader</li>
		  <li>Ekaterina Vasyuchenko — Compilation of data for the database, developer</li>
		  <li>Philipp Orekhov — Compilation of data for the database, developer</li>
		  <li>Grigoriy Armeev — Technical Management</li>
	  </ul>
      
    <div id='table-container'></div>
	<table id="example" class="table table-striped table-bordered"  style="width:100%">
        <thead>
            <tr>
				<th></th>
                <th>Name</th>
				<th>SMILES</th>
				<th>PubChemID</th>
				<th>CPE CLASS</th>
				<th>IUPAC NAME</th>
				<th>CAS</th>
				<th>CAS (cactus)</th>
				<th>logKp</th>
				<th>Reference</th>
				<th>Total Molweight</th>
				<th>cLogP</th>
				<th>cLogS</th>
				<th>H-Acceptors</th>
				<th>H-Donors</th>
				<th>Polar Surface Area</th>
				<th>Rotatable Bonds</th>
				<th>Aromatic Rings</th>
				<th>sp3-Atoms</th>
				<th>Drug status</th>
				<th>DRUGBANK</th>
				<th>tag1</th>
				<th>tag2</th>
				<th>tag3</th>
				<th>tag4</th>
				<th>tag5</th>
				<th>tag6</th>
				<th>tag7</th>
				<th>tag8 (SCAFFOLD name)</th>
				<th>Scaffold SMILES</th>
            </tr>
        </thead>
    </table>
    <div id="tooltip"></div>
    </div><!-- /.container -->



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
 
	<script type="text/javascript" src="DataTables/jQuery-3.3.1/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="DataTables/Bootstrap-3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="DataTables/datatables.min.js"></script>

	



<!--
{ "render": function ( data, type, row, meta ) { if ( 'display' === type ) { data = '<div class="tooltip"> ' + data + '<span class="tooltiptext"><img src="https://cactus.nci.nih.gov/chemical/structure/' + data + '/image"/></span></div>'; } return data; }, "targets": [ 1 ] }]
-->



    <script type="text/javascript">
	
	const copyToClipboard = str => {
	  const el = document.createElement('textarea');
	  el.value = str;
	  document.body.appendChild(el);
	  el.select();
	  document.execCommand('copy');
	  document.body.removeChild(el);
	};
	
	function format ( d ) {
    // `d` is the original data object for the row
    return '<table class="table table-striped table-bordered" cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
        '<tr>'+
            '<td><b>IUPAC NAME:</b></td>'+
            '<td colspan="5">'+d['IUPAC NAME']+'</td>'+
        '</tr>'+
		'<tr>'+
            '<td><b>Total molecular weight:</b></td>'+
            '<td>'+d["Total Molweight"]+'</td>'+
			'<td><b>cLogP:</b></td>'+
            '<td>'+d['cLogP']+'</td>'+
			'<td><b>cLogS:</b></td>'+
            '<td>'+d['cLogS']+'</td>'+
        '</tr>'+


		'<tr>'+
            '<td><b>H-Acceptors:</b></td>'+
            '<td>'+d['H-Acceptors']+'</td>'+
			'<td><b>H-Donors:</b></td>'+
            '<td>'+d['H-Donors']+'</td>'+
			'<td><b>Polar Surface Area:</b></td>'+
            '<td>'+d['Polar Surface Area']+'</td>'+
        '</tr>'+
		
		'<tr>'+
            '<td><b>Rotatable Bonds:</b></td>'+
            '<td>'+d['Rotatable Bonds']+'</td>'+
			'<td><b>Aromatic Rings:</b></td>'+
            '<td>'+d['Aromatic Rings']+'</td>'+
			'<td><b>sp3-Atoms:</b></td>'+
            '<td>'+d['sp3-Atoms']+'</td>'+
        '</tr>'+
		'<tr>'+
            '<td><b>Drug status:</b></td>'+
            '<td>'+d['Aromatic Rings']+'</td>'+
			'<td><b>DRUGBANK:</b></td>'+
            '<td colspan="3">'+d['DRUGBANK']+'</td>'+
        '</tr>'+
		
		'<tr>'+
            '<td><b>Reference:</b></td>'+
            '<td colspan="5">'+d.Reference+'</td>'+
        '</tr>'+
    '</table>';
}
	
	$(document).ready(function() {
	
    var table =$('#example').DataTable( {
        "ajax": "data/db.json",
        "columns": [
			{
				className:      'details-control',
				orderable:      false,
				data:           null,
				defaultContent: ''
			},
            { "data": "Name" },
			{ "data": "SMILES" },
			{ "data": "PubChemID" },
			{ "data": "CPE CLASS" },
			{ "data": "IUPAC NAME" },
			{ "data": "CAS" },
			{ "data": "CAS (cactus)" },
			{ "data": "logKp" },
			{ "data": "Reference" },
			{ "data": "Total Molweight" },
			{ "data": "cLogP" },
			{ "data": "cLogS" },
			{ "data": "H-Acceptors" },
			{ "data": "H-Donors" },
			{ "data": "Polar Surface Area" },
			{ "data": "Rotatable Bonds" },
			{ "data": "Aromatic Rings" },
			{ "data": "sp3-Atoms" },
			{ "data": "Drug status" },
			{ "data": "DRUGBANK" },
			{ "data": "tag1" },
			{ "data": "tag2" },
			{ "data": "tag3" },
			{ "data": "tag4" },
			{ "data": "tag5" },
			{ "data": "tag6" },
			{ "data": "tag7" },
			{ "data": "tag8 (SCAFFOLD name)" },
			{ "data": "Scaffold SMILES" }
        ],
		"ordering": false,
		"paging": false,
		"initComplete": function(settings, json) {
			$('[data-toggle="tooltip"]').tooltip({
			  class: "tooltip-main",
			  animation: false,
			  html: true,
			  delay: {show: 300, hide: 100}
			});
		},
		"columnDefs": [
						{
							"targets":  1 ,
						    "render": function ( data, type, row, meta ) 
							{
							if ( 'display' === type ) 
							{ 
								data = '<a data-toggle="tooltip" data-placement="bottom" title="<img class=\'img-thumbnail mx-auto d-block float-left\' src=\'https://cactus.nci.nih.gov/chemical/structure/'+ row.SMILES +'/image\'>">'+data+'</a>' } 
								return data; 
							}
						},
						{
							targets: 2,
							render: function (data, type, row, meta)
							{
								if (type === 'display')
									data = '<div class="hiddentext" style="visibility:hidden;position: absolute;top: 0px;left: -5000px;">'+
									data+'</div><button type="button" class="btn btn-primary" onclick="copyToClipboard(\''+data+'\')">Copy</button>'
								return data;
							}
						},
						{
							targets: 3,
							render: function (data, type, row, meta)
							{
								if (type === 'display')
									data = "<a href='https://pubchem.ncbi.nlm.nih.gov/compound/" + data + "' target='_blank'>" + data + "</a>";
								return data;
							}
						},
						{
							targets: 6,
							render: function (data, type, row, meta)
							{
								if (type === 'display')
									data = '<a href="https://webbook.nist.gov/cgi/cbook.cgi?ID=' + data + '&Units=SI" target="_blank">' + data + "</a>";
								return data;
							}
						},
						{
							"targets": [5,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29],
							"visible": false,
							"searchable": true
						}
					],
    } );
	
	$('#example tbody').on('click', 'td.details-control', function () {
        var tr = $(this).closest('tr');
        var row = table.row( tr );
 
        if ( row.child.isShown() ) {
            // This row is already open - close it
            row.child.hide();
            tr.removeClass('shown');
        }
        else {
            // Open this row
            row.child( format(row.data()) ).show();
            tr.addClass('shown');
        }
    } );
	
	 
	
//	$('#example tbody').on('mouseover', 'tr', function(e) {
//	   var tr = $(this).closest('tr');
//       var row = table.row( tr );
//	   console.log(row.data().SMILES)
//	   $("#tooltip").text(row.data().SMILES).animate({ left: e.pageX, top: e.pageY }, 1)
//	   if (!$("#tooltip").is(':visible')) $("#tooltip").show()
//	})
//	$('#example').on('mouseleave', function(e) {
//	  $("#tooltip").hide()
//	}) 

	
	
    $('button').on('mousedown', function(){
      $('[data-toggle="tooltip"]').tooltip('hide');
    });
    $('[data-toggle="tooltip"]').on('mouseleave', function(){
      $('[data-toggle="tooltip"]').tooltip('hide');
    });
	
} );


	
    </script>
  </body>
</html>
